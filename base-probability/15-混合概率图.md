# æ··åˆæ¦‚ç‡å›¾

## 1. éš Markov æ¨¡å‹

- æ¦‚ç‡å›¾æ¨¡å‹
  - æœ‰å‘å›¾
    - è´å¶æ–¯ç½‘ç»œ
  - æ— å‘å›¾
    - Markov éšæœºåœº

è‹¥æ ·æœ¬ä¹‹é—´å­˜åœ¨å…³è”ï¼Œå¯ä»¥è®¤ä¸ºæ ·æœ¬ä¸­é™„å¸¦äº†æ—¶åºä¿¡æ¯ï¼Œä»è€Œæ ·æœ¬ä¹‹é—´ä¸ç‹¬ç«‹å…¨åŒåˆ†å¸ƒçš„ï¼Œè¿™ç§æ¨¡å‹å°±ç§°ä¸ºåŠ¨æ€æ¨¡å‹ï¼Œéšå˜é‡éšç€æ—¶é—´å‘ç”Ÿå˜åŒ–ï¼Œäºæ˜¯è§‚æµ‹å˜é‡ä¹Ÿå‘ç”Ÿå˜åŒ–

```mermaid
graph LR;
z1-->z2-->z3;
```

æ ¹æ®çŠ¶æ€å˜é‡çš„ç‰¹ç‚¹ï¼Œå¯ä»¥åˆ†ä¸º

- ç¦»æ•£ï¼šéš Markov æ¨¡å‹
- è¿ç»­
  - çº¿æ€§ï¼šKalman æ»¤æ³¢
  - éçº¿æ€§ï¼šç²’å­æ»¤æ³¢

## 2. HMM

éš Markov æ¨¡å‹ï¼ˆHMMï¼‰æ˜¯ä¸€ç§æ¦‚ç‡å›¾æ¨¡å‹ã€‚ç”¨æ¦‚ç‡å›¾è¡¨ç¤ºä¸ºï¼š

```mermaid
graph TD;
t1-->t2;
subgraph four
	t4-->x4((x4))
end
subgraph three
	t3-->x3((x3))
end
subgraph two
	t2-->x2((x2))
end
subgraph one
	t1-->x1((x1))
end

t2-->t3;
t3-->t4;
```

ä¸Šå›¾è¡¨ç¤ºäº†å››ä¸ªæ—¶åˆ»çš„éšå˜é‡å˜åŒ–ã€‚ç”¨å‚æ•° $Î»=(Ï€, ğ‘¨, ğ‘©)$æ¥è¡¨ç¤ºï¼Œå…¶ä¸­ï¼Œ$Ï€$æ˜¯å¼€å§‹çš„æ¦‚ç‡åˆ†å¸ƒï¼Œ$ğ‘¨$ä¸ºçŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œ$ğ‘©$ä¸ºå‘å°„çŸ©é˜µã€‚

ä¸‹é¢ä½¿ç”¨ $o*t$æ¥è¡¨ç¤ºè§‚æµ‹å˜é‡ï¼Œ$O$ä¸ºè§‚æµ‹åºåˆ—ï¼Œ$V= \{v_1,v_2, â‹¯,v_M\}$è¡¨ç¤ºè§‚æµ‹çš„å€¼åŸŸï¼Œ$i_t$è¡¨ç¤ºçŠ¶æ€å˜é‡ï¼Œ$I$ä¸ºçŠ¶æ€åºåˆ—ï¼Œ$Q= \{q_1,q_2, â‹¯,q_N\}$è¡¨ç¤ºçŠ¶æ€å˜é‡çš„å€¼åŸŸã€‚å®šä¹‰ $ğ‘¨=(a*{ij} =p(i\_{t+1} =q_{j}|i_t=q_i))$è¡¨ç¤ºçŠ¶æ€è½¬ç§»çŸ©é˜µï¼Œ$ğ‘©=(b_{j}(k)=p(o_t=v_k|i_t=q_{j}))$è¡¨ç¤ºå‘å°„çŸ©é˜µã€‚

åœ¨ HMM ä¸­ï¼Œæœ‰ä¸¤ä¸ªåŸºæœ¬å‡è®¾

1. é½æ¬¡ Markov å‡è®¾ï¼ˆæœªæ¥åªä¾èµ–äºå½“å‰ï¼‰

$$
p(i_{t+1}|i_t, i_{t-1}, â‹¯, i_1, o_t, o_{t-1}, â‹¯, o_1)=p(i_{t+1}|i_t)
$$

2. è§‚æµ‹ç‹¬ç«‹å‡è®¾

$$
p(o_t|i_t, i_{t-1}, â‹¯, i_1, o_{t-1}, â‹¯, o_1)=p(o_t|i_t)
$$

HMM è¦è§£å†³ä¸‰ä¸ªé—®é¢˜ï¼š

1. è¯„ä¼°ï¼ˆForward-Backward ç®—æ³•ï¼‰
   - $p(O|Î»)$
2. å­¦ä¹ ï¼ˆEM ç®—æ³•ï¼Œå³ Baum-Welch ç®—æ³•ï¼‰
   - $Î» = \mathrm{argmax}\underset{Î»}{p(O|Î»)}$ï¼Œ
3. è§£ç ï¼ˆVierbi ç®—æ³•ï¼‰
   - $I = \mathrm{argmax}\underset{I}{p(I|O, Î»)}$
   - é¢„æµ‹é—®é¢˜ï¼š$p(i_{t+1}|o_1, o_2, â‹¯, o_t)$
   - æ»¤æ³¢é—®é¢˜ï¼š$p(i_t|o_1, o_2, â‹¯, o_t)$

### 2.1. è¯„ä¼°

$$
p(O|Î») = âˆ‘_I p(I,O|Î») = âˆ‘_I p(O|I, Î»)p(I|Î»)
$$

$$
p(I|Î»)=p(i_1, i_2, â‹¯, i_t|Î»)=p(i_t|i_1, i_2, â‹¯, i_{t-1}, Î»)p(i_1, i_2, â‹¯, i_{t-1}|Î»)
$$

æ ¹æ®é½æ¬¡ Markov å‡è®¾ï¼š

$$
p(i_t|i_1, i_2, â‹¯, i_{t-1}, Î»)=p(i_t|i_{t-1})=a_{i_{t-1}i_t}
$$

æ•…ï¼š

$$
p(I|Î») = Ï€_1âˆ_{t=2}^{âŠ¤}a_{i_{t-1}, i_t}
$$

åˆç”±äºï¼š

$$
p(O|I, Î»)= âˆ_{t=1}^{âŠ¤}b_{i_t}(o_t)
$$

äºæ˜¯ï¼š

$$
p(O|Î») = âˆ‘_I Ï€_{i_1}âˆ_{t=2}^{âŠ¤}a_{i_{t-1}, i_t}âˆ_{t=1}^{âŠ¤}b_{i_t}(o_t)
$$

ä¸Šé¢çš„å¼å­ä¸­çš„æ±‚å’Œç¬¦å·æ˜¯å¯¹æ‰€æœ‰çš„è§‚æµ‹å˜é‡æ±‚å’Œï¼Œäºæ˜¯å¤æ‚åº¦ä¸º $O(N^{âŠ¤})$ã€‚

ä¸‹é¢ï¼Œè®° $Î±_t(i)=p(o_1, o_2, â‹¯, o_t, i_t=q_i|Î»)$ï¼Œæ•…ï¼Œ$Î±_T(i)=p(O, i_T=q_i|Î»)$ã€‚å¾—

$$
p(O|Î») = âˆ‘_{i=1}^n p(O, i_T=q_i|Î») = âˆ‘_{i=1}^n Î±_T(i)
$$

å¯¹ $Î±_{t+1}(j)$ï¼š

$$
\begin{aligned}
Î±_{t+1}(j)  &= p(o_1, o_2, â‹¯, o_{t+1}, i_{t+1} =q_{j}|Î») \\
 &=  âˆ‘_{i=1}^n p(o_1, o_2, â‹¯, o_{t+1}, i_{t+1} =q_{j}, i_t=q_i|Î») \\
 &=  âˆ‘_{i=1}^n p(o_{t+1}|o_1, o_2, â‹¯, i_{t+1} =q_{j}, i_t=q_i|Î»)p(o_1, â‹¯, o_t, i_t=q_i, i_{t+1} =q_{j}|Î»)
\end{aligned}
$$

åˆ©ç”¨è§‚æµ‹ç‹¬ç«‹å‡è®¾

$$
\begin{aligned}
Î±_{t+1}(j)  &=  âˆ‘_{i=1}^n p(o_{t+1}|i_{t+1} =q_{j})p(o_1, â‹¯, o_t, i_t=q_i, i_{t+1} =q_{j}|Î») \\
 &=  âˆ‘_{i=1}^n p(o_{t+1}|i_{t+1} =q_{j})p(i_{t+1} =q_{j}|o_1, â‹¯, o_t, i_t=q_i, Î»)p(o_1, â‹¯, o_t, i_t=q_i|Î») \\
 &=  âˆ‘_{i=1}^nb_{j}(o_t)a_{ij}Î±_t(i)
\end{aligned}
$$

ä¸Šé¢åˆ©ç”¨äº†é½æ¬¡ Markov å‡è®¾å¾—åˆ°äº†ä¸€ä¸ªé€’æ¨å…¬å¼ï¼Œè¿™ä¸ªç®—æ³•ç§°ä¸ºå‰å‘ç®—æ³•ã€‚

è¿˜æœ‰ä¸€ç§ç®—æ³•ç§°ä¸ºåå‘ç®—æ³•ï¼Œå®šä¹‰ $Î²_t(i)=p(o_{t+1}, o_{t+1}, â‹¯ï¼Œo_T|i_t=i, Î»)$ï¼š

$$
\begin{aligned}
p(O|Î»)  &= p(o_1, â‹¯, o_T|Î») \\
 &=  âˆ‘_{i=1}^n p(o_1, o_2, â‹¯, o_T, i_1=q_i|Î») \\
 &=  âˆ‘_{i=1}^n p(o_1, o_2, â‹¯, o_T|i_1=q_i, Î»)Ï€_i\\
 &=  âˆ‘_{i=1}^n p(o_1|o_2, â‹¯, o_T, i_1=q_i, Î»)p(o_2, â‹¯, o_T|i_1=q_i, Î»)Ï€_i\\
 &=  âˆ‘_{i=1}^nb_i(o_1)Ï€_iÎ²_1(i)
\end{aligned}
$$

å¯¹äºè¿™ä¸ª $Î²_1(i)$ï¼š

$$
\begin{aligned}
Î²_t(i)  &= p(o_{t+1}, â‹¯, o_T|i_t=q_i) \\
 &=  âˆ‘_{j=1}^n p(o_{t+1}, o_{t+2}, â‹¯, o_T, i_{t+1} =q_{j}|i_t=q_i) \\
 &=  âˆ‘_{j=1}^n p(o_{t+1}, â‹¯, o_T|i_{t+1} =q_{j}, i_t=q_i)p(i_{t+1} =q_{j}|i_t=q_i) \\
 &=  âˆ‘_{j=1}^n p(o_{t+1}, â‹¯, o_T|i_{t+1} =q_{j})a_{ij} \\
 &=  âˆ‘_{j=1}^n p(o_{t+1}|o_{t+2}, â‹¯, o_T, i_{t+1} =q_{j})p(o_{t+2}, â‹¯, o_T|i_{t+1} =q_{j})a_{ij} \\
 &=  âˆ‘_{j=1}^nb_{j}(o_{t+1})a_{ij}Î²_{t+1}(j)
\end{aligned}
$$

äºæ˜¯åå‘åœ°å¾—åˆ°äº†ç¬¬ä¸€é¡¹ã€‚

### 2.2. å­¦ä¹ 

ä¸ºäº†å­¦ä¹ å¾—åˆ°å‚æ•°çš„æœ€ä¼˜å€¼ï¼Œåœ¨ MLE ä¸­ï¼š

$$
Î»_\mathrm{MLE} = \mathrm{argmax}_Î» p(O|Î»)
$$

é‡‡ç”¨ EM ç®—æ³•ï¼ˆåœ¨è¿™é‡Œä¹Ÿå« Baum Welch ç®—æ³•ï¼‰ï¼Œç”¨ä¸Šæ ‡è¡¨ç¤ºè¿­ä»£ï¼š

$$
Î¸^{t+1} = \mathrm{argmax}_Î¸ âˆ«_z\log p(X,Z \mid Î¸)p(Z|X, Î¸^t)dz
$$

å…¶ä¸­ï¼Œ$X$æ˜¯è§‚æµ‹å˜é‡ï¼Œ$Z$æ˜¯éšå˜é‡åºåˆ—ã€‚äºæ˜¯ï¼š

$$
Î»^{t+1} = \mathrm{argmax}_Î»âˆ‘_i\log p(O, I|Î»)p(I|O, Î»^t) \\
= \mathrm{argmax}_Î»âˆ‘_i\log p(O, I|Î»)p(O, I|Î»^t)
$$

è¿™é‡Œåˆ©ç”¨äº† $p(O|Î»^t)$å’Œ$Î»$æ— å…³ã€‚å°† Evaluation ä¸­çš„å¼å­ä»£å…¥ï¼š

$$
âˆ‘_i\log p(O, I|Î»)p(O, I|Î»^t) = âˆ‘_i[\log Ï€_{i_1}+ âˆ‘_{t=2}^{âŠ¤} \log a_{i_{t-1}, i_t}+ âˆ‘_{t=1}^{âŠ¤} \log b_{i_t}(o_t)]p(O, I|Î»^t)
$$

å¯¹ $Ï€^{t+1}$ï¼š

$$
\begin{aligned}Ï€^{t+1}  &=  \mathrm{argmax}_Ï€âˆ‘_i[\log Ï€_{i_1}p(O, I|Î»^t)] \\
 &=  \mathrm{argmax}_Ï€âˆ‘_i[\log Ï€_{i_1}â‹… p(O, i_1, i_2, â‹¯, i_T|Î»^t)]
\end{aligned}
$$

ä¸Šé¢çš„å¼å­ä¸­ï¼Œå¯¹ $i_2, i_2, â‹¯, i_T$æ±‚å’Œå¯ä»¥å°†è¿™äº›å‚æ•°æ¶ˆæ‰ï¼š

$$
Ï€^{t+1} = \mathrm{argmax}_Ï€âˆ‘_{i_1}[\log Ï€_{i_1}â‹… p(O, i_1|Î»^t)]
$$

ä¸Šé¢çš„å¼å­è¿˜æœ‰å¯¹ $Ï€$çš„çº¦æŸ $âˆ‘_iÏ€_i=1$ã€‚å®šä¹‰ Lagrange å‡½æ•°ï¼š

$$
L(Ï€,Î·) = âˆ‘_{i=1}^n \log Ï€_iâ‹… p(O, i_1=q_i|Î»^t)+Î·(âˆ‘_{i=1}^nÏ€_i -1)
$$

äºæ˜¯ï¼š

$$
\frac{âˆ‚L}{âˆ‚Ï€_i} = \frac{1}{Ï€_i}p(O, i_1=q_i|Î»^t)+Î·=0
$$

å¯¹ä¸Šå¼æ±‚å’Œï¼š

$$
âˆ‘_{i=1}^n p(O, i_1=q_i|Î»^t)+Ï€_iÎ·=0â‡’Î·=-p(O|Î»^t)
$$

æ•…ï¼š

$$
Ï€_i^{t+1} = \frac{p(O, i_1=q_i|Î»^t)}{p(O|Î»^t)}
$$

### 2.3. è§£ç 

è§£ç  é—®é¢˜è¡¨è¿°ä¸ºï¼š

$$
I= \mathrm{argmax}\underset{I}p(I|O, Î»)
$$

æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªåºåˆ—ï¼Œå…¶æ¦‚ç‡æœ€å¤§ï¼Œè¿™ä¸ªåºåˆ—å°±æ˜¯åœ¨å‚æ•°ç©ºé—´ä¸­çš„ä¸€ä¸ªè·¯å¾„ï¼Œå¯ä»¥é‡‡ç”¨åŠ¨æ€è§„åˆ’çš„æ€æƒ³ã€‚

å®šä¹‰ï¼š

$$
Î´_{t}(j) = \max\underset{i_1, â‹¯, i_{t-1}}p(o_1, â‹¯, o_t, i_1, â‹¯, i_{t-1}, i_t=q_i)
$$

äºæ˜¯ï¼š

$$
Î´_{t+1}(j) = \max\underset{1 â‰¤ i â‰¤ N}Î´_t(i)a_{ij}b_{j}(o_{t+1})
$$

è¿™ä¸ªå¼å­å°±æ˜¯ä»ä¸Šä¸€æ­¥åˆ°ä¸‹ä¸€æ­¥çš„æ¦‚ç‡å†æ±‚æœ€å¤§å€¼ã€‚è®°è¿™ä¸ªè·¯å¾„ä¸ºï¼š

$$
Ïˆ_{t+1}(j) = \mathrm{argmax}\underset{1 â‰¤ i â‰¤ N}Î´_t(i)a_{ij}
$$

## 3. å°ç»“

HMM æ˜¯ä¸€ç§åŠ¨æ€æ¨¡å‹ï¼Œæ˜¯ç”±æ··åˆæ ‘å½¢æ¨¡å‹å’Œæ—¶åºç»“åˆèµ·æ¥çš„ä¸€ç§æ¨¡å‹ï¼ˆç±»ä¼¼ GMM + Timeï¼‰ã€‚å¯¹äºç±»ä¼¼ HMM çš„è¿™ç§çŠ¶æ€ç©ºé—´æ¨¡å‹ï¼Œæ™®éçš„é™¤äº†å­¦ä¹ ä»»åŠ¡ï¼ˆé‡‡ç”¨ EMï¼‰å¤–ï¼Œè¿˜æœ‰æ¨æ–­ä»»åŠ¡ï¼Œæ¨æ–­ä»»åŠ¡åŒ…æ‹¬ï¼š

1. è¯‘ç  è§£ç ï¼š$p(z_1,z_2, â‹¯,z_t \mid x_1, x_2, â‹¯, x_t)$

2. ä¼¼ç„¶æ¦‚ç‡ï¼š$p(X \mid Î¸)$

3. æ»¤æ³¢ï¼š$p(z_t \mid x_1, â‹¯, x_t)$ï¼ŒOnline

   $$
   p(z_t \mid x_{1:t}) = \frac{p(x_{1:t},z_t)}{p(x_{1:t})} =CÎ±_t(z_t)
   $$

4. å¹³æ»‘ï¼š$p(z_t \mid x_1, â‹¯, x_T)$ï¼ŒOffline

   $$
   p(z_t \mid x_{1:T}) = \frac{p(x_{1:T},z_t)}{p(x_{1:T})} = \frac{Î±_t(z_t)p(x_{t+1:T} \mid x_{1:t},z_t)}{p(x_{1:T})}
   $$

   æ ¹æ®æ¦‚ç‡å›¾çš„æ¡ä»¶ç‹¬ç«‹æ€§ï¼Œæœ‰ï¼š

   $$
   p(z_t \mid x_{1:T}) = \frac{Î±_t(z_t)p(x_{t+1:T} \mid z_t)}{p(x_{1:T})} =CÎ±_t(z_t)Î²_t(z_t)
   $$

   è¿™ä¸ªç®—æ³•ç§°ä¸ºå‰å‘åå‘ç®—æ³•ã€‚

5. é¢„æµ‹ï¼š$p(z_{t+1},z_{t+2} \mid x_1, â‹¯, x_t),p(x_{t+1}, x_{t+2} \mid x_1, â‹¯, x_t)$

   $$
   p(z_{t+1} \mid x_{1:t}) = âˆ‘_{z_t}p(z_{t+1},z_t \mid x_{1:t}) = âˆ‘_{z_t}p(z_{t+1} \mid z_t)p(z_t \mid x_{1:t})
   $$

   $$
   p(x_{t+1} \mid x_{1:t}) = âˆ‘_{z_{t+1}}p(x_{t+1},z_{t+1} \mid x_{1:t}) = âˆ‘_{z_{t+1}}p(x_{t+1} \mid z_{t+1})p(z_{t+1} \mid x_{1:t})
   $$

## 4. å¡å°”æ›¼æ»¤æ³¢

HMM æ¨¡å‹é€‚ç”¨äºéšå˜é‡æ˜¯ç¦»æ•£çš„å€¼çš„æ—¶å€™ï¼Œå¯¹äºè¿ç»­éšå˜é‡çš„ HMMï¼Œå¸¸ç”¨å¡å°”æ›¼æ»¤æ³¢æè¿°çº¿æ€§é«˜æ–¯æ¨¡å‹çš„æ€å˜é‡ï¼Œä½¿ç”¨ç²’å­æ»¤æ³¢æ¥è¡¨è¿°éé«˜æ–¯éçº¿æ€§çš„æ€å˜é‡ã€‚

LDS åˆå«å¡å°”æ›¼æ»¤æ³¢ï¼Œå…¶ä¸­ï¼Œçº¿æ€§ä½“ç°åœ¨ä¸Šä¸€æ—¶åˆ»å’Œè¿™ä¸€æ—¶åˆ»çš„éšå˜é‡ä»¥åŠéšå˜é‡å’Œè§‚æµ‹ä¹‹é—´ï¼š

$$
\begin{aligned}
z_t &= ğ‘¨â‹…z_{t-1}+ğ‘©+É›\\
x_t &= Câ‹…z_t+D+Î´\\
É›& âˆ¼ N(0,Q) \\
Î´& âˆ¼ N(0,R)
\end{aligned}
$$

ç±»æ¯” HMM ä¸­çš„å‡ ä¸ªå‚æ•°ï¼š

$$
\begin{aligned}
p(z_t \mid z_{t-1}) & âˆ¼ N(ğ‘¨â‹…z_{t-1}+ğ‘©,Q) \\
p(x_t \mid z_t) & âˆ¼ N(Câ‹…z_t+D,R) \\
z_1 & âˆ¼ N(Î¼_1, Î£_1)
\end{aligned}
$$

åœ¨å«æ—¶çš„æ¦‚ç‡å›¾ä¸­ï¼Œé™¤äº†å¯¹å‚æ•°è¯„ä¼°çš„å­¦ä¹ é—®é¢˜å¤–ï¼Œåœ¨æ¨æ–­ä»»åŠ¡ä¸­ï¼ŒåŒ…æ‹¬è¯‘ç ï¼Œè¯æ®æ¦‚ç‡ï¼Œæ»¤æ³¢ï¼Œå¹³æ»‘ï¼Œé¢„æµ‹é—®é¢˜ï¼ŒLDS æ›´å…³å¿ƒæ»¤æ³¢è¿™ä¸ªé—®é¢˜ï¼š$p(z_t \mid x_1, x_2, â‹¯, x_t)$ã€‚ç±»ä¼¼ HMM ä¸­çš„å‰å‘ç®—æ³•ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªé€’æ¨å…³ç³»ã€‚

$$
p(z_t \mid x_{1:t})=p(x_{1:t},z_t)/p(x_{1:t})=Cp(x_{1:t},z_t)
$$

å¯¹äº $p(x_{1:t},z_t)$ï¼š

$$
\begin{aligned}
p(x_{1:t},z_t)  &= p(x_t \mid x_{1:t-1},z_t)p(x_{1:t-1},z_t)=p(x_t \mid z_t)p(x_{1:t-1},z_t) \\
 &= p(x_t \mid z_t)p(z_t \mid x_{1:t-1})p(x_{1:t-1})=Cp(x_t \mid z_t)p(z_t \mid x_{1:t-1}) \\
\end{aligned}
$$

æˆ‘ä»¬çœ‹åˆ°ï¼Œå³è¾¹é™¤äº†åªå’Œè§‚æµ‹ç›¸å…³çš„å¸¸æ•°é¡¹ï¼Œè¿˜æœ‰ä¸€é¡¹æ˜¯é¢„æµ‹ä»»åŠ¡éœ€è¦çš„æ¦‚ç‡ã€‚å¯¹è¿™ä¸ªå€¼ï¼š

$$
\begin{aligned}
p(z_t \mid x_{1:t-1})  &=  âˆ«_{z_{t-1}}p(z_t,z_{t-1} \mid x_{1:t-1})dz_{t-1} \\
 &=  âˆ«_{z_{t-1}}p(z_t \mid z_{t-1}, x_{1:t-1})p(z_{t-1} \mid x_{1:t-1})dz_{t-1} \\
 &=  âˆ«_{z_{t-1}}p(z_t \mid z_{t-1})p(z_{t-1} \mid x_{1:t-1})dz_{t-1}
\end{aligned}
$$

æˆ‘ä»¬çœ‹åˆ°ï¼Œè¿™åˆåŒ–æˆäº†ä¸€ä¸ªæ»¤æ³¢é—®é¢˜ã€‚äºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªé€’æ¨å…¬å¼ï¼š

1. $t=1$ï¼Œ$p(z_1 \mid x_1)$ï¼Œç§°ä¸º update è¿‡ç¨‹ï¼Œç„¶åè®¡ç®— $p(z_2 \mid x_1)$ï¼Œé€šè¿‡ä¸Šé¢çš„ç§¯åˆ†è¿›è¡Œï¼Œç§°ä¸º prediction è¿‡ç¨‹ã€‚
2. $t=2$ï¼Œ$p(z_2 \mid x_2, x_1)$å’Œ $p(z_3 \mid x_1, x_2)$

æˆ‘ä»¬çœ‹åˆ°ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸€ä¸ª Online çš„è¿‡ç¨‹ï¼Œå¯¹äºæˆ‘ä»¬çš„çº¿æ€§é«˜æ–¯å‡è®¾ï¼Œè¿™ä¸ªè®¡ç®—è¿‡ç¨‹éƒ½å¯ä»¥å¾—åˆ°è§£æè§£ã€‚

1. Predictionï¼š

   $$
   p(z_t \mid x_{1:t-1}) = âˆ«_{z_{t-1}}p(z_t \mid z_{t-1})p(z_{t-1} \mid x_{1:t-1})dz_{t-1} = âˆ«_{z_{t-1}}N(ğ‘¨z_{t-1}+ğ‘©,Q)N(Î¼_{t-1}, Î£_{t-1})dz_{t-1}
   $$

   å…¶ä¸­ç¬¬äºŒä¸ªé«˜æ–¯åˆ†å¸ƒæ˜¯ä¸Šä¸€æ­¥çš„ Update è¿‡ç¨‹ï¼Œæ•…æ ¹æ®çº¿æ€§é«˜æ–¯æ¨¡å‹ï¼Œç›´æ¥å¯ä»¥å†™å‡ºè¿™ä¸ªç§¯åˆ†ï¼š

   $$
   p(z_t \mid x_{1:t-1})=N(ğ‘¨Î¼_{t-1}+ğ‘©, Q + ğ‘¨Î£_{t-1}ğ‘¨^{âŠ¤})
   $$

2. Update:
   $$
   p(z_t \mid x_{1:t})âˆ p(x_t \mid z_t)p(z_t \mid x_{1:t-1})
   $$
   åŒæ ·åˆ©ç”¨çº¿æ€§é«˜æ–¯æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å†™å‡ºè¿™ä¸ªé«˜æ–¯åˆ†å¸ƒã€‚

## 5. ç²’å­æ»¤æ³¢

Kalman æ»¤æ³¢æ ¹æ®çº¿æ€§é«˜æ–¯æ¨¡å‹å¯ä»¥æ±‚å¾—è§£æè§£ï¼Œä½†æ˜¯åœ¨éçº¿æ€§ï¼Œéé«˜æ–¯çš„æƒ…å†µï¼Œæ˜¯æ— æ³•å¾—åˆ°è§£æè§£çš„ï¼Œå¯¹è¿™ç±»ä¸€èˆ¬çš„æƒ…å†µï¼Œæˆ‘ä»¬ç§°ä¸ºç²’å­æ»¤æ³¢ï¼Œæˆ‘ä»¬éœ€è¦æ±‚å¾—æ¦‚ç‡åˆ†å¸ƒï¼Œéœ€è¦é‡‡ç”¨é‡‡æ ·çš„æ–¹å¼ã€‚

å¯¹äºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œè‹¥æˆ‘ä»¬å¸Œæœ›è®¡ç®—ä¾è¿™ä¸ªåˆ†å¸ƒçš„æŸä¸ªå‡½æ•° $f(z)$çš„æœŸæœ›ï¼Œå¯ä»¥åˆ©ç”¨æŸç§æŠ½æ ·æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ¦‚ç‡åˆ†å¸ƒä¸­æŠ½å– $N$ä¸ªæ ·æœ¬ï¼Œåˆ™ $\mathrm{E}\big[f(z)\big]âˆ¼eq\frac{1}{N} âˆ‘_{i=1}^nf(z_i)$ã€‚ä½†æ˜¯è‹¥è¿™ä¸ªæ¦‚ç‡ååˆ†å¤æ‚ï¼Œåˆ™é‡‡æ ·æ¯”è¾ƒå›°éš¾ã€‚å¯¹äºå¤æ‚çš„æ¦‚ç‡åˆ†å¸ƒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„æ¦‚ç‡åˆ†å¸ƒ $q(z)$ä½œä¸ºæ¡¥æ¢ï¼ˆé‡è¦å€¼é‡‡æ ·ï¼‰:

$$
\mathrm{E}\big[f(z)\big] = âˆ«_zf(z)p(z)dz= âˆ«_zf(z)\frac{p(z)}{q(z)}q(z)dz= âˆ‘_{i=1}^nf(z_i)\frac{p(z_i)}{q(z_i)}
$$

äºæ˜¯ç›´æ¥é€šè¿‡å¯¹ $q(z)$é‡‡æ ·ï¼Œç„¶åå¯¹æ¯ä¸€ä¸ªé‡‡æ ·çš„æ ·æœ¬åº”ç”¨æƒé‡å°±å¾—åˆ°äº†æœŸæœ›çš„è¿‘ä¼¼ï¼Œå½“ç„¶ä¸ºäº†æ¦‚ç‡åˆ†å¸ƒçš„ç‰¹æ€§ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æƒé‡è¿›è¡Œå½’ä¸€åŒ–ã€‚

åœ¨æ»¤æ³¢é—®é¢˜ä¸­ï¼Œéœ€è¦æ±‚è§£ $p(z_t \mid x_{1:t})$ï¼Œå…¶æƒé‡ä¸ºï¼š

$$
w_t^i= \frac{p(z_t^i | x_{1:t})}{q(z_t^i | x_{1:t})}, i = 1,2, â‹¯,N
$$

äºæ˜¯åœ¨æ¯ä¸€ä¸ªæ—¶åˆ» $t$ï¼Œéƒ½éœ€è¦é‡‡æ · $N$ä¸ªç‚¹ï¼Œä½†æ˜¯å³ä½¿é‡‡æ ·äº†è¿™ä¹ˆå¤šç‚¹ï¼Œåˆ†å­ä¸Šé¢çš„é‚£ä¸€é¡¹ä¹Ÿååˆ†éš¾æ±‚ï¼Œäºæ˜¯å¸Œæœ›æ‰¾åˆ°ä¸€ä¸ªå…³äºæƒé‡çš„é€’æ¨å…¬å¼ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥åºåˆ—é‡è¦æ€§é‡‡æ ·ï¼ˆSISï¼‰ã€‚

## 6. SIS

åœ¨ SIS ä¸­ï¼Œè§£å†³çš„é—®é¢˜æ˜¯ $p(z_{1:t} \mid x_{1:t})$ã€‚

$$
w_t^iâˆ\frac{p(z_{1:t} \mid x_{1:t})}{q(z_{1:t} \mid x_{1:t})}
$$

æ ¹æ® LDS ä¸­çš„æ¨å¯¼ï¼š

$$
\begin{aligned}p(z_{1:t} \mid x_{1:t})âˆ p(x_{1:t},z_{1:t})  &= p(x_t \mid z_{1:t}, x_{1:t-1})p(z_{1:t}, x_{1:t-1}) \\
 &= p(x_t \mid z_t)p(z_t \mid x_{1:t-1},z_{1:t-1})p(x_{1:t-1},z_{1:t-1}) \\
 &= p(x_t \mid z_t)p(z_t \mid z_{t-1})p(x_{1:t-1},z_{1:t-1}) \\
&âˆ p(x_t \mid z_t)p(z_t \mid z_{t-1})p(z_{1:t-1} \mid x_{1:t-1})
\end{aligned}
$$

äºæ˜¯åˆ†å­çš„é€’æ¨å¼å°±å¾—åˆ°äº†ã€‚å¯¹äºæè®®åˆ†å¸ƒçš„åˆ†æ¯ï¼Œå¯ä»¥å–ï¼š

$$
q(z_{1:t} \mid x_{1:t})=q(z_t \mid z_{1:t-1}, x_{1:t})q(z_{1:t-1} \mid x_{1:t-1})
$$

æ•…æœ‰ï¼š

$$
w_t^iâˆ\frac{p(z_{1:t} \mid x_{1:t})}{q(z_{1:t} \mid x_{1:t})}âˆ \frac{p(x_t \mid z_t)p(z_t \mid z_{t-1})p(z_{1:t-1} \mid x_{1:t-1})}{q(z_t \mid z_{1:t-1}, x_{1:t})q(z_{1:t-1} \mid x_{1:t-1})} = \frac{p(x_t \mid z_t)p(z_t \mid z_{t-1})}{q(z_t \mid z_{1:t-1}, x_{1:t})} w_{t-1}^i
$$

å¾—åˆ°çš„å¯¹æƒé‡çš„ç®—æ³•ä¸ºï¼š

1. $t-1$æ—¶åˆ»ï¼Œé‡‡æ ·å®Œæˆå¹¶è®¡ç®—å¾—åˆ°æƒé‡
2. t æ—¶åˆ»ï¼Œæ ¹æ® $q(z_t \mid z_{1:t-1}, x_{1:t})$è¿›è¡Œé‡‡æ ·å¾—åˆ° $z_t^i$ã€‚ç„¶åè®¡ç®—å¾—åˆ° $N$ä¸ªæƒé‡ã€‚
3. æœ€åå¯¹æƒé‡å½’ä¸€åŒ–ã€‚

SIS ç®—æ³•ä¼šå‡ºç°æƒå€¼é€€åŒ–çš„æƒ…å†µï¼Œåœ¨ä¸€å®šæ—¶é—´åï¼Œå¯èƒ½ä¼šå‡ºç°å¤§éƒ¨åˆ†æƒé‡éƒ½é€¼è¿‘ 0 çš„æƒ…å†µï¼Œè¿™æ˜¯ç”±äºç©ºé—´ç»´åº¦è¶Šæ¥è¶Šé«˜ï¼Œéœ€è¦çš„æ ·æœ¬ä¹Ÿè¶Šæ¥è¶Šå¤šã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•æœ‰ï¼š

1. é‡é‡‡æ ·ï¼Œä»¥æƒé‡ä½œä¸ºæ¦‚ç‡åˆ†å¸ƒï¼Œé‡æ–°åœ¨å·²ç»é‡‡æ ·çš„æ ·æœ¬ä¸­é‡‡æ ·ï¼Œç„¶åæ‰€æœ‰æ ·æœ¬çš„æƒé‡ç›¸åŒï¼Œè¿™ä¸ªæ–¹æ³•çš„æ€è·¯æ˜¯å°†æƒé‡ä½œä¸ºæ¦‚ç‡åˆ†å¸ƒï¼Œç„¶åå¾—åˆ°ç´¯ç§¯å¯†åº¦å‡½æ•°ï¼Œåœ¨ç´¯ç§¯å¯†åº¦ä¸Šå–ç‚¹ï¼ˆé˜¶æ¢¯å‡½æ•°ï¼‰ã€‚
2. é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æè®®åˆ†å¸ƒï¼Œ$q(z_t \mid z_{1:t-1}, x_{1:t})=p(z_t \mid z_{t-1})$ï¼Œäºæ˜¯å°±æ¶ˆæ‰äº†ä¸€é¡¹ï¼Œå¹¶ä¸”é‡‡æ ·çš„æ¦‚ç‡å°±æ˜¯ $p(z_t \mid z_{t-1})$ï¼Œè¿™å°±ç§°ä¸ºç”Ÿæˆä¸æµ‹è¯•æ–¹æ³•ã€‚

é‡‡ç”¨é‡é‡‡æ ·çš„ SIS ç®—æ³•å°±æ˜¯åŸºæœ¬çš„ç²’å­æ»¤æ³¢ç®—æ³•ã€‚è‹¥åƒä¸Šé¢é‚£æ ·é€‰æ‹©æè®®åˆ†å¸ƒï¼Œè¿™ä¸ªç®—æ³•ç§°ä¸º SIR ç®—æ³•ã€‚
