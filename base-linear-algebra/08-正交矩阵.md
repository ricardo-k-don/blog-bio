# 正交矩阵

## 1. 正交向量

### 1.1. 正交基

**定义**：已知$𝒑_1, 𝒑_2, …, 𝒑_r$为向量空间$𝒱$的一个基，如果两两正交，即满足

$$
𝒑_i ⋅ 𝒑_j = 0, \ i ≠ j
$$

则称其为正交基（orthogonal basis）。若其还满足长度均为$1$，即

$$
𝒑_i ⋅ 𝒑_i = 1, \ i = 1, 2, …, r
$$

则称其为标准正交基（orthonormal basis）。

:::{admonition} 定理

互相正交的单位向量一定是线性无关的。

:::

### 1.2. 正交矩阵

**定义**：设$𝒑_1, 𝒑_2, …, 𝒑_n$是向量空间$ℝ^n$的一个标准正交基，则由其构造的$n$阶方阵$𝑷$称为正交矩阵（orthogonal matrix）

$$
𝑷 = (𝒑_1, 𝒑_2, …, 𝒑_n)
$$

该方阵$𝑷$必然满足

$$
𝑷^{⊤}𝑷 = 𝑷^{-1}𝑷 = 𝑰
$$

**定义**：由标准正交向量构成的矩阵，即$𝑸 = \big[𝒒_1 𝒒_2 ⋯ 𝒒_n\big]$。根据定义

$$
𝑸^{⊤}𝑸 =
\begin{bmatrix}
  1 & & & \\
  & 1 & & \\
  & & ⋱ & \\
  & & & 1
\end{bmatrix} = 𝑰
$$

称为标准正交矩阵（orthonormal matrix）。

:::{admonition} 定理

标准正交矩阵相似于单位矩阵。

:::

:::{admonition} 定理

当$𝑸$恰好是方阵时，由于正交性，易得$𝑸$是可逆的，又$𝑸^{⊤}𝑸 = 𝑰$，故$𝑸^{⊤} = 𝑸^{-1}$。

:::

### 1.3. 施密特正交化

由上，正交矩阵的逆矩阵很容易求出，若对角化中用到的矩阵$𝑷$可以构造为正交矩阵，即有$𝑷^{-1} = 𝑷^{⊤}$，则可大大降低对角化的求解难度，使得

$$
𝑨 = 𝑷𝜦𝑷^{-1} = 𝑷𝜦𝑷^{⊤}
$$

设$𝒒_1, …, 𝒒_m$是$𝒱$的标准正交基，且$𝒗 ∈ 𝒱$，则

$$
𝒗 = ⟨𝒗, 𝒒_1⟩ 𝒒_1 + ⋯ + ⟨𝒗, 𝒒_n⟩ 𝒒_n
$$

$$
∥𝒗 ∥^2 = \big|⟨𝒗, 𝒒_1⟩\big|^2 + ⋯ + \big|⟨𝒗, 𝒒_n⟩\big|^2
$$

:::{admonition} Gram-Schmidt 正交化

设向量空间$𝒱$中，$𝒗_1, …, 𝒗_m$是一组基，可通过下述方法找到$𝒱$中的一组正交基

$$
\begin{aligned}
  𝒒_1 &= 𝒗_1 \\
  𝒒_2 &= 𝒗_2 - \frac{𝒗_2⋅𝒒_1}{𝒒_1⋅𝒒_1}𝒒_1 \\
  𝒒_3 &= 𝒗_3 - \frac{𝒗_3⋅𝒒_1}{𝒒_1⋅𝒒_1}𝒒_1 - \frac{𝒗_3⋅𝒒_2}{𝒒_2⋅𝒒_2}𝒒_2 \\
  &⋮ \\
  𝒒_n &= 𝒗_n - \frac{𝒗_n⋅𝒒_1}{𝒒_1⋅𝒒_1}𝒒_1 - … - \frac{𝒗_n⋅𝒒_{n-1}}{𝒒_{n-1}⋅𝒒_{n-1}}𝒒_{n-1}
\end{aligned}
$$

其中，$𝒒_1, …, 𝒒_n$是$𝒱$中的一组标准正交基

:::

> 正交化就是去除多余分量的过程。

### 1.4. 正交对角化

## 2. 旋转矩阵

### 2.1. 二维旋转

标准正交矩阵$𝑸$也称旋转矩阵，其将任意向量逆时针旋转$θ$，其逆矩阵$𝑸^{-1}$将任意向量顺时针旋转$θ$。

如下矩阵

$$
𝑨_{2d} =
\begin{bmatrix}
\cos{θ} & -\sin{θ} \\
\sin{θ} & \cos{θ}
\end{bmatrix}
$$

通过左乘$𝑨𝒂 = 𝒃$，使得$𝒃$相对$𝒂$围绕原点逆时针旋转了$θ$。

### 2.2. 三维旋转

- 围绕 Z 轴旋转的角度 θ

$$
𝑨_{3dz}=
\begin{bmatrix}
\cos{θ} & -\sin{θ} & 0 \\
\sin{θ} & \cos{θ} & 0 \\
0 & 0 & 1
\end{bmatrix}
$$

请注意，Z 坐标仍然不受这种旋转的影响，即

$$
\begin{bmatrix}
\cos{θ} & -\sin{θ} & 0 \\
\sin{θ} & \cos{θ} & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
x \\ y \\ z
\end{bmatrix}=
\begin{bmatrix}
. \\ . \\ z
\end{bmatrix}
$$

- 围绕 X 轴旋转的角度 θ

$$
𝑨_{3dx} =
\begin{bmatrix}
1 & 0 & 0 \\
0 & \cos{θ} & -\sin{θ} \\
0 & \sin{θ} & \cos{θ}
\end{bmatrix}
$$

请注意，X 坐标仍然不受这种旋转的影响，即

$$
\begin{bmatrix}
1 & 0 & 0 \\
0 & \cos{θ} & -\sin{θ} \\
0 & \sin{θ} & \cos{θ}
\end{bmatrix}
\begin{bmatrix}
x \\ y \\ z
\end{bmatrix} =
\begin{bmatrix}
x \\ . \\ .
\end{bmatrix}
$$

- 围绕 Y 轴旋转的角度 θ

$$
𝑨_{3dy} =
\begin{bmatrix}
\cos{θ} & 0 & -\sin{θ} \\
0 & 1 & 0 \\
\sin{θ} & 0 & \cos{θ}
\end{bmatrix}
$$

请注意，Y 坐标仍然不受这种旋转的影响，即

$$
\begin{bmatrix}
\cos{θ} & 0 & -\sin{θ} \\
0 & 1 & 0 \\
\sin{θ} & 0 & \cos{θ}
\end{bmatrix}
\begin{bmatrix}
x \\ y \\ z
\end{bmatrix} =
\begin{bmatrix}
. \\ y \\ .
\end{bmatrix}
$$

### 2.3. 旋转与正交

矩阵$𝑹$是正交的，当且仅当它的转置也是它的逆时，即

$$
𝑹^{⊤}𝑹 = 𝑹𝑹^{⊤} = 𝑰
$$

所有的旋转矩阵都是正交矩阵。所有正交矩阵都代表某种旋转。

- 正交性意味着旋转是长度保守的
- 旋转的角度求负数，相当于对旋转矩阵求逆，相当于对旋转矩阵转置

旋转矩阵的特征值和特征向量

$$
\begin{aligned}
& 𝒙^{⊤} 𝑹^{⊤}(𝑹 𝒙)=λ 𝒙^{⊤}(λ 𝒙) \\
⇔ & 𝒙^{⊤}(𝑹^{⊤}𝑹) 𝒙 = λ^2 𝒙^{⊤} 𝒙 \\
⇔ & 𝒙^{⊤} 𝒙 = λ^2 𝒙^{⊤} 𝒙 \\
⇔ & λ^2 = 1 \\
⇔ & λ=1
\end{aligned}
$$

- 旋转矩阵总有特征值 1。相应的特征向量将是旋转的轴
- 在三维中，另外两个特征值将是复数，产生旋转的角度
