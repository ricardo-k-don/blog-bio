# 矩阵的秩

## 1. 四个子空间

### 1.1. 列空间

**定义**：矩阵$𝑨$的列向量为：

$$
𝑨 =
\begin{bmatrix}
a_{11} & a_{12} & … & a_{1n} \\
a_{21} & a_{22} & … & a_{3n} \\
⋮ & ⋮ & … & ⋮ \\
a_{m1} & a_{m2} & … & a_{mn}
\end{bmatrix}
= (𝒄_1, 𝒄_2, …, 𝒄_n)
$$

包含所有列向量的向量组称为列向量组，即$\{𝒄_1, 𝒄_2, …, 𝒄_n\}$。列向量组的张成空间称为列空间，记作$\mathrm{colsp}(𝑨)$。

- 列向量组的秩，即列空间的维度，称为列秩。
- 若列向量组线性无关，即称为列满秩。

### 1.2. 行空间

$$
𝑨 =
\begin{bmatrix}
a_{11} & a_{12} & … & a_{1n} \\
a_{21} & a_{22} & … & a_{3n} \\
⋮ & ⋮ & … & ⋮ \\
a_{m1} & a_{m2} & … & a_{mn}
\end{bmatrix}
=
\begin{bmatrix}
  𝒓^{⊤}_1 \\ 𝒓^{⊤}_2 \\ ⋮ \\ 𝒓^{⊤}_m
\end{bmatrix}
$$

包含所有行向量的向量组称为行向量组，即$\{𝒓^{⊤}_1, 𝒓^{⊤}_2, …, 𝒓^{⊤}_m\}$。行向量组的张成空间称为行空间，记作$\mathrm{rowsp}(𝑨)$。

- 行向量组的秩，即行空间的维度，称为行秩。
- 若行向量组线性无关，即称为行满秩。

### 1.3. 子空间的维度

对于$m × n$矩阵$𝑨$，$rank(𝑨) = r$有

|  子空间  |    表示    | 空间  |  维度   |
| :------: | :--------: | :---: | :-----: |
|  列空间  |   $C(𝑨)$   | $ℝ^m$ |   $r$   |
|  零空间  |   $N(𝑨)$   | $ℝ^n$ | $n - r$ |
|  行空间  | $C(𝑨^{⊤})$ | $ℝ^n$ |   $r$   |
| 左零空间 | $N(𝑨^{⊤})$ | $ℝ^m$ | $m - r$ |

- 主元所在的列，即可组成列空间的一组基。
- 自由元所在的列，即可组成零空间的一组基。

## 2. 矩阵的秩

### 2.1. 定义

**定义**：对任意矩阵$𝑨$，始终有列秩等于行秩，所以统称为矩阵的秩，即矩阵的秩 = 列秩 = 行秩

### 2.2. 性质

:::{admonition} 定理

若某矩阵$𝑨$同时满足行满秩和列满秩，则称该矩阵为满秩矩阵，满秩矩阵必为方阵。

:::

:::{admonition} 定理

对于$m × n$矩阵$𝑨$，

$$
rank(𝑨) ≤ \min(m, n)
$$

:::

:::{admonition} 定理

$$
rank(𝑨^{⊤}) = rank(𝑨)
$$

$$
rank(𝑨𝑩) ≤ \min(rank(𝑨), rank(𝑩))
$$

:::

:::{admonition} 定理

设$𝑷$和$𝑸$为满秩矩阵，则有

$$
rank(𝑨) = rank(𝑷𝑨) = rank(𝑨𝑸) = rank(𝑷𝑨𝑸)
$$

:::

:::{admonition} 定理

设$𝑨$和$𝑩$为同型矩阵，则

$$
rank(𝑨 + 𝑩) ≤ rank(𝑨) + rank(𝑩)
$$

:::

:::{admonition} 定理

$$
rank(𝑨𝑩) ≥ rank(𝑨) + rank(𝑩) - n
$$

:::

### 2.3. 行变换

:::{admonition} 定理

行梯队矩阵（row echelon form，REF）的秩就是其非零行的个数。

:::

:::{admonition} 定理

任意非零矩阵$𝑨$总可经过有限次行初等变换转化为 REF 和唯一的 RREF。且

$$
rank(𝑨) = rank(\mathrm{𝑨_{REF}})
$$

:::

### 2.4. 列变换

**定义**：左上角为单位阵，其余位置均为$0$的矩阵，称为标准形矩阵，如

$$
\begin{bmatrix}
\begin{bmatrix}
1 & 0 \\
0 & 1
\end{bmatrix}
& 0 \\
\begin{matrix}
0 & 0  \\
\end{matrix}
& 0
\end{bmatrix}
$$

:::{admonition} 定理

任意最简形矩阵$𝑨$总可经过有限次初等列变换转化为唯一的标准形矩阵。

:::

## 3. 矩阵函数

### 3.1. 几个定义

**定义**：假设有两个非空集合$X$和$Y$，若这两个集合存在一种对应关系$f$，该对应关系满足：

- $X$中的所有元素均有$Y$中元素与之对应
- $X$中的元素只能有唯一的$Y$的元素与之对应

则称该对应关系为函数，表示为$Y = f(X)$。

**定义**：若$𝑨$为系数矩阵，$𝒙$为未知数矩阵，$𝒚$为列向量，则称$𝑨𝒙 = 𝒚$为矩阵函数。其输入为$𝒙$，输出为$𝒚$。

**定义**：同时满足以下两个性质的函数

- 齐次性：$ℒ(a𝒙) = aℒ(𝒙)$
- 可加性：$ℒ(x + y) = ℒ(x) + ℒ(y)$

被称为线性函数。

矩阵函数有四个基本要素

- 定义域：集合$X$
- 到达域：集合$Y$
- 映射规则：指定集合$X$和集合$Y$的关系，记作$f: X → Y$
- 值域：$X$通过映射规则，映射到$Y$到值

### 3.2. 定义域

**定义**：使函数有意义的一切元素组成的集合称为自然定义域。

### 3.3. 映射规则

- 单射：当且仅当每个$y$，至多有 1 个$x$与之对应
- 满射：当且仅当每个$y$，至少有 1 个$x$与之对应
- 双射：当且仅当每个$y$，只能有 1 个$x$与之对应

> 同时满足单射和满射，方为双射。

若矩阵函数所代表的线性函数可写作$ℒ: ℝ^n → ℝ^m$，则有

| 自然定义域 | 映射法则 |           值域            | 到达域 |
| :--------: | :------: | :-----------------------: | :----: |
|   $ℝ^n$    |   $𝑨$    | $𝑨𝒙$或$\mathrm{colsp}(𝑨)$ | $ℝ^m$  |

:::{admonition} 定理

自然定义域下，矩阵函数$𝑨𝒙 = 𝒚$的值域就是矩阵$𝑨$的列空间。

:::

### 3.4. 维度和秩

:::{admonition} 定理

当定义域为向量空间时，有

- 矩阵函数是单射 ⇔ 定义域维度 = 值域维度
- 矩阵函数非单射 ⇔ 定义域维度 > 值域维度
- 矩阵函数是满射 ⇔ 到达域维度 = 值域维度
- 矩阵函数是双射 ⇔ 定义域维度 = 值域维度 = 到达域维度

:::

:::{admonition} 定理

自然定义域下，

- $𝑨$是列满秩矩阵 ⇔ $𝑨𝒙 = 𝒚$是单射
- $𝑨$是行满秩矩阵 ⇔ $𝑨𝒙 = 𝒚$是满射

:::

## 4. 逆矩阵

### 4.1. 定义

**定义**：对方阵$𝑨$，若存在如下矩阵$𝑩$，使得

$$
𝑨𝑩 = 𝑩𝑨 = 𝑰
$$

则称$𝑨$可逆（invertible）。

:::{admonition} 定理

当$𝑨$为满秩矩阵时，对应的矩阵函数为双射，此时$𝑨$存在反函数$𝑨^{-1}$，称为$𝑨$的逆矩阵。

:::

> 双射函数存在反函数，可以通过几何逆变换（无损）为原函数。在此过程中，信息不会丢失。

:::{admonition} 定理

若矩阵$𝑨$是可逆的，则只存在一个矩阵$𝑩$，使$𝑨𝑩 = 𝑩𝑨 = 𝑰$。

:::

### 4.2. 求逆矩阵

:::{admonition} 定理

若通过一系列初等行矩阵$𝑬_i$，可将矩阵$𝑨$变成单位阵$𝑰$，则$𝑨$的逆矩阵就是这些初等行矩阵的乘积

$$
\underbrace{𝑬_1𝑬_2…𝑬_n}_{𝑨^{-1}}𝑨 = 𝑰
$$

:::

**定义**：将矩阵$𝑨$和矩阵$𝑰$纵向堆叠成一个矩阵$(𝑨 | 𝑰)$，然后对新矩阵进行一系列初等行变换，由此可得$(𝑰 | 𝑨^{-1})$，此即高斯-若尔当法。

### 4.3. 逆的性质

:::{admonition} 定理

若矩阵$𝑨$可逆，则

- $𝑨^{-1}$可逆，且$(𝑨^{-1})^{-1} = 𝑨$
- $𝑨^{⊤}$可逆，且$(𝑨^{⊤})^{-1} = (𝑨^{-1})^{⊤}$
- $λ𝑨$可逆（λ ≠ 0），且$(λ𝑨)^{-1} = \frac{1}{λ}𝑨$
- 若$n$为非负整数，则$𝑨^n$可逆，且$(𝑨^n)^{-1} = (𝑨^{-1})^n$

:::

:::{admonition} 定理

若同型矩阵$𝑨$和$𝑩$可逆，则乘积$𝑨𝑩$可逆，且$(𝑨𝑩)^{-1} = 𝑩^{-1} 𝑨^{-1}$。

:::

:::{admonition} 定理

对二阶方阵

$$
𝑨 =
\begin{bmatrix}
  a & b \\
  c & d
\end{bmatrix}
$$

当且仅当$ad = bc ≠ 0$，则是可逆的，在这种情况下

$$
𝑨^{-1} = \frac{1}{ad - bc}
\begin{bmatrix}
  d & - b \\
  -c & a
\end{bmatrix}
$$

:::

:::{admonition} 定理

若$n$阶方阵$𝑨$是可逆的，则对于任何$n$个向量$𝒃$，该系统

$$
𝑨𝒙 = 𝒃
$$

有唯一解

$$
𝒙 = 𝑨^{-1} 𝒃
$$

:::

## 5. 秩一矩阵

$2×3$矩阵

$$
𝑨 =
\begin{bmatrix}
  1 &4&5\\
  2 &8& 10
\end{bmatrix} =
\begin{bmatrix}
  1\\2
\end{bmatrix}
\begin{bmatrix}
  1 &4&5
\end{bmatrix}
$$

且$\dim C(𝑨) = 1 = \dim C(𝑨^{⊤})$，所有的秩一矩阵都可以划为$𝑨 = 𝑼𝑽^{⊤}$的形式，这里的$𝑼, 𝑽$均为列向量。

> 秩一矩阵类似"积木"，可以搭建任何矩阵。

现在，在$ℝ^4$空间中有向量

$$
v= \begin{bmatrix}
  v_1 \\ v_2 \\ v_3 \\ v_4
\end{bmatrix}
$$

取$ℝ^4$中满足$v_1 + v_2 + v_3 + v_4 = 0$的所有向量组成一个向量空间$S$，则$S$是一个向量子空间。易看出，不论是使用系数乘以该向量，或是用两个满足条件的向量相加，其结果仍然落在分量和为零的向量空间中。

求$S$的维数

$v_1 + v_2 + v_3 + v_4 = 0$等价于

$$
\begin{bmatrix}
  1 & 1 & 1 & 1
\end{bmatrix}
\begin{bmatrix}
  v_1\\ v_2\\ v_3\\ v_4
\end{bmatrix} = 0
$$

则$S$就是$𝑨 = \begin{bmatrix}1 & 1 & 1 & 1\end{bmatrix}$的零空间。

$rank(𝑨) = 1$，则对其零空间有$rank(N(𝑨)) = n - r = 3 = \dim N(𝑨)$，则$S$的维数是$3$。

$1×4$矩阵$𝑨$的四个基本子空间：

- 零空间：$\dim N(𝑨) =3$，其中的一组基是

$$
\begin{bmatrix}
  -1\\ 1\\ 0\\ 0
\end{bmatrix}
\begin{bmatrix}
  -1\\ 0\\ 1\\ 0
\end{bmatrix}
\begin{bmatrix}
  -1\\ 0\\ 0\\ 1
\end{bmatrix}
$$

- 行空间：$\dim C(𝑨^{⊤}) = 1$，其中的一组基是

$$
\begin{bmatrix}
  1\\ 1\\ 1\\ 1
\end{bmatrix}
$$

- 列空间：$\dim C(𝑨) = 1$，其中一组基是

$$
\begin{bmatrix}
1
\end{bmatrix}
$$

可以看出列空间就是整个$ℝ$空间。

- 左零空间：$\dim N(𝑨^{⊤}) = 0$，因为$𝑨$转置后，没有非零的$𝒗$可以使$𝑨𝒗 = 0$成立，就是

$$
\begin{bmatrix}
0
\end{bmatrix}
$$

综上

$$
\begin{aligned}
\dim C(𝑨^{⊤}) + &\dim N(𝑨) &= 4 &= n\\
\dim C(𝑨) + &\dim N(𝑨^{⊤}) &= 1 &= m
\end{aligned}
$$
