# 矩阵

## 1. 线性方程组

### 1.1. 线性系统

符合如下形式的方程

$$
a_1x_1 + a_2x_2 + ⋯ + a_nx_n = b
$$

称为含有$n$元线性方程（linear equation）。其中，$a_1, a_2, ⋯ a_n$称为系数（coefficient）且不全为$0$，$x_1, x_2, ⋯ x_n$称为变量（variable）。

由$n$个变量$x_1, x_2, …, x_n$中的$m$个线性方程组，被称为线性系统（linear system），可以写成以下形式

$$
\begin{cases}
\begin{aligned}
  a_{11}x_1 + a_{12}x_2 + & ⋯ + a_{1n}x_n = b_1 \\
  a_{21}x_1 + a_{22}x_2 + & ⋯ + a_{2n}x_n = b_2 \\
  & ⋮ \\
  a_{m1}x_1 + a_{m2}x_2 + & ⋯ + a_{mn}x_n = b_m
\end{aligned}
\end{cases}
$$

其中，下标$i$指的是方程，下标$j$指的是变量。

当$𝒃_i = 0$时，该线性系统称为齐次系统（homogeneous system）。

:::{admonition} 叠加原理

叠加原理（superposition），也叫线性可加性，是线性系统的充要条件，即

对系统

$$
ẋ = f(x)
$$

若$x_1$和$x_2$为该系统的解，则$x_3 = k_1x_1 + k_2x_2$必为该系统的解，其中$k_1$和$k_2$为常数。

:::

线性系统的 2 个性质

### 1.2. 系数矩阵

线性系统中，等式左边的未知数系数可以多维数组的形式提取出来，称为系数矩阵（coefficient matrix）

$$
𝑨 =
\begin{bmatrix}
  a_{11} & a_{12} & ⋯ & a_{1n} \\
  a_{21} & a_{22} & ⋯ & a_{2n} \\
  ⋮ & ⋮ & ⋱ & ⋮ \\
  a_{m1} & a_{m2} & ⋯ & a_{mn}
\end{bmatrix}
$$

$𝑨$的条目$a_{ij}$中，第一个下标$i$指定所在的$𝑨$的行，第二个下标$j$指定所在的$𝑨$的列。

**定义**：矩阵（matrix）是一个简单的矩形数组，其组成部分被称为矩阵的条目（entry）或元素（element）。矩阵大小（size）或形状（shape）是由它有多少水平行和垂直列来指定的。

> 向量可以看作是一维矩阵

### 1.3. 增广矩阵

将系数矩阵中右边的常数列写成

$$
𝒃 =
\begin{bmatrix}
  b_1 \\ b_2 \\ ⋮ \\ b_m
\end{bmatrix}
$$

当将常数向量$𝒃$与系数矩阵$𝑨$纵向堆叠时，得到矩阵

$$
\begin{bmatrix}
𝑨 & 𝒃
\end{bmatrix} =
\begin{bmatrix}
  a_{11} & a_{12} & ⋯ & a_{1n} & b_1 \\
  a_{21} & a_{22} & ⋯ & a_{2n} & b_2 \\
  ⋮ & ⋮ & ⋱ & ⋮ & ⋮ \\
  a_{m1} & a_{m2} & ⋯ & a_{mn} & b_m
\end{bmatrix}
$$

这个矩阵称为线性系统的增广系数矩阵（augmented coefficient matrix），或简称增广矩阵。

## 2. 矩阵初等运算

### 2.1. 矩阵加法

**定义**：当两个矩阵的行数、列数均分别相等时，称其为同型矩阵。

**定义**：若$𝑨 = a_{ij}$和$𝑩 = b_{ij}$是同型矩阵，则其和$𝑨 + 𝑩$就是将矩阵$𝑨$和$𝑩$的相应元素相加得到的矩阵，即

$$
𝑨 + 𝑩 = \big[a_{ij} + b_{ij} \big]
$$

其中，右边的符号表示矩阵$𝑨 + 𝑩$的第$i$行和第$j$列中的元素是$a_{ij} + b_{ij}$。

### 2.2. 标量乘法

**定义**：若$𝑨 = a_{ij}$是一个矩阵，$c$是一个常数，则$c𝑨$是$𝑨$的每个元素乘以$c$得到的矩阵，即

$$
c𝑨 = \big[ca_{ij}\big]
$$

利用标量乘法，可以定义矩阵$𝑨$的负数$-𝑨$和两个矩阵$𝑨$和$𝑩$的差值$𝑨 - 𝑩$，写法是

$$
\begin{aligned}
-𝑨 &= (-1) 𝑨 \\
𝑨 - 𝑩 &= 𝑨 + (-𝑩)
\end{aligned}
$$

|          | 交换律 | 结合率 | 分配律 |
| :------: | :----: | :----: | :----: |
|   加法   |   ✓    |   ✓    |   -    |
| 标量乘法 |   -    |   ✓    |   ✓    |

### 2.3. 初等行运算

**定义**：以下是矩阵$𝑨$的三种基本行操作

1. 将$𝑨$的任意行做标量乘法
2. 将$𝑨$的任意两行相加
3. 将$𝑨$的两行互换

**定义**：若一个矩阵可以通过有限次初等行运算从另一个矩阵中得到，则称为行等价（row equivalent）。

## 3. 矩阵化简

### 3.1. 行梯队矩阵

矩阵$𝑬$称为行梯队矩阵（row echelon form，REF），只要它具有以下两个性质

1. 若$𝑬$有任何全零的行，则它们被分组在矩阵的底部。其他每行中的第一个（从左起）非零元素称为它的前导条目（leading entry）也叫主元（pivot）
2. 主元（蓝色）形成了一个从左上到右下的"下楼梯"模式，示例如下

$$
𝑬 =
\begin{bmatrix}
  \textcolor{blue} 2 & -1 & 0 & 4 & 7 \\
  0 & \textcolor{blue} 1 & 2 & 0 & -5 \\
  0 & 0 & 0 & \textcolor{blue} 3 & 0 \\
  0 & 0 & 0 & 0 & 0
\end{bmatrix}
$$

设一个线性系统是梯队形式，它的增广矩阵是行梯队矩阵，则那些对应于含有主元的列的变量称为前导变量（leading variables），其他变量都称为自由变量（free variables）。

### 3.2. 高斯消元

对高斯消元（Gaussian elimination）的系统性描述清楚地表明，它适用于任何给定矩阵$𝑨$。

:::{admonition} 高斯消元

1. 找到$𝑨$中第一个包含非零元素的列
2. 若这一列中的第一个条目为零，则将$𝑨$的第一行与相应条目为非零的行互换
3. 现在列中的第一个条目非零。将它下面的条目在同一列中用零代替，方法是在下行$𝑨$的第一行中加入适当的倍数
4. 在步骤 1∼3 之后，矩阵看起来像下面的矩阵，尽管可能有几个初始列是 0，甚至根本没有。在指示的右下矩阵$𝑨_1$上执行步骤 1∼3。
5. 重复此循环步骤，直到得到一个梯队矩阵

:::

$$
𝑨 =
\begin{bmatrix}
  0 & * & \# & \# & … & \# \\
  \hline
  0 & 0 & & \\
  0 & 0 & & \\
  ⋮ & ⋮ & & & {𝑨_1} \\
  0 & 0 & & &
\end{bmatrix}
$$

简言之，从左到右逐列对矩阵$𝑨$进行处理。在每一列包含一个主元，"清除"它下面的非零元素，然后转到下一列。

### 3.3. 高斯-若尔当消元

**定义**：行最简梯队矩阵（reduced row echelon form，RREF）$𝑬$是一个具有以下属性的梯队矩阵

1. $𝑬$的每个主元均是 1
2. $𝑬$的每个主元均是其列中唯一的非零元素

将矩阵$𝑨$转化为 RREF 的过程称为高斯-若尔当消元（Gauss-Jordan Elimination）。

:::{admonition} 高斯-若尔当消元

1. 首先用高斯消除法将$𝑨$转化为梯队形式。
2. 然后将每行非零的元素除以其主元。
3. 最后，用每个主元 1 来"清除"其列中剩余的非零元素。

:::

:::{admonition} 定理

每个矩阵都行等价于一个且仅有一个的最简梯队矩阵。

:::

## 4. 矩阵的积

### 4.1. 向量积（点积）

矩阵的向量积，又称矩阵乘法（matrix multiplication），是向量乘法的叠加，代表线性映射（linear mapping）。

> 在$𝑨_{m×n}𝒙_{n×1} = 𝒃_{m×1}$中矩阵$𝑨_{m×n}$扮演的角色就是完成$𝒙 → 𝒃$线性映射。

设$𝑨$是一个$m × n$矩阵，$𝑩$是一个$n × p$矩阵，则$𝑨𝑩$被定义为$m × p$矩阵，其第$i$行，第$j$列的项由下式给出

$$
𝑪_{ij} = (𝑨𝑩)_{ij} = ∑_{k=1}^n a_{ik} b_{kj}
$$

$$
\begin{aligned}
𝑪 &= 𝑨𝑩 \\
&=
\begin{bmatrix}
1 & 2 & 3 \\
4 & 5 & 6
\end{bmatrix}
\begin{bmatrix}
1 & 4 \\
2 & 5 \\
3 & 6
\end{bmatrix} \\
&=
\begin{bmatrix}
1×1 + 2×2 + 3×3 & 1×4 + 2×5 + 3×6 \\
4×1 + 5×2 + 6×3 & 4×4 + 5×5 + 6×6
\end{bmatrix} \\
&=
\begin{bmatrix}
14 & 32 \\
32 & 77
\end{bmatrix}
\end{aligned}
$$

> 即，列分向量 × 行分向量 + 矩阵加法

### 4.2. 数量积

矩阵$𝑨$和$𝑩$为同型矩阵，$a_{ij}$和$b_{ij}$分别为矩阵$𝑨$和$𝑩$的项，则乘积矩阵的第$i$行，第$j$列的项由下式给出

$$
c_{ij} = a_{ij}b_{ij}
$$

### 4.3. 张量积

$$
𝑪_{ij} = a_{ij}𝑩
$$

$$
\begin{aligned}
𝑪 &= 𝑨 𝑩 \\
&= \begin{bmatrix}
1 & 2 \\ 3 & 1
\end{bmatrix}
⊗
\begin{bmatrix}
0 & 3 \\ 2 & 1
\end{bmatrix} \\
&= \begin{bmatrix}
1⋅0 & 1⋅3 & 2⋅0 & 0⋅3 \\
1⋅2 & 1⋅1 & 2⋅2 & 2⋅1 \\
0⋅0 & 3⋅3 & 1⋅0 & 1⋅3 \\
3⋅2 & 3⋅1 & 1⋅2 & 1⋅1
\end{bmatrix} \\
&= \begin{bmatrix}
0 & 3 & 0 & 6 \\
2 & 1 & 4 & 2 \\
0 & 9 & 0 & 3 \\
6 & 3 & 2 & 1
\end{bmatrix}
\end{aligned}
$$

|   积   |     别名     | 矩阵 $𝑨$ | 矩阵 $𝑩$ | 矩阵 $𝑪$  |   表示    |
| :----: | :----------: | :------: | :------: | :-------: | :-------: |
| 向量积 |     点积     | $m × p$  | $p × n$  |  $m × n$  | $𝑪 = 𝑨⋅𝑩$ |
| 数量积 | Hadamard 积  | $m × n$  | $m × n$  |  $m × n$  | $𝑪 = 𝑨⨀𝑩$ |
| 张量积 | Kronecker 积 | $m × n$  | $p × q$  | $mp × nq$ | $𝑪 = 𝑨⨂𝑩$ |

### 4.4. 初等矩阵

**定义**：若对$n$阶单位矩阵$𝑰$行运算就可以得到$n$阶方阵$𝑬$，则称为初等矩阵（elementary matrix）。

:::{admonition} 定理

若对$m × n$个矩阵$𝑨$进行初等运算，则结果就是乘积矩阵$𝑬𝑨$，其中，$𝑬$是对$n × n$个单位矩阵进行同样的行运算得到的初等矩阵。

:::

:::{admonition} 定理

当且仅当$n$阶方阵$𝑨$与$n$阶单位矩阵$𝑰$行等价时，则$n$阶方阵$𝑨$可逆。

:::

对矩阵

$$
𝑨 =
\begin{bmatrix}
1 & 3 \\ 2 & 7
\end{bmatrix}
$$

构造矩阵

$$
\begin{bmatrix}
1 & 3 & 1 & 0 \\
2 & 7 & 0 & 1
\end{bmatrix}
$$

使用高斯-若尔当方法，将$\big[𝑨 \ 𝑰 \big]$变为$\big[𝑰 \ 𝑨^{-1} \big]$

$$
\begin{aligned}
\begin{bmatrix}
1 & 3 & 1 & 0 \\
2 & 7 & 0 & 1
\end{bmatrix}
&⇒ \begin{bmatrix}
1 & 3 & 1 & 0 \\
0 & 1 & -2 & 1
\end{bmatrix} \\
&⇒ \begin{bmatrix}
1 & 0 & 7 & -3 \\
0 & 1 & -2 & 1
\end{bmatrix}
\end{aligned}
$$
