# 复线性空间

## 1. 复向量

对复向量

$$
z= \begin{bmatrix}
z_1\\
z_2\\
⋮\\
z_n
\end{bmatrix}
$$

向量的每个分量均是复数。此时$z∉ℝ^n$，它现在处于$ℂ^n$复向量空间。

通常情况，计算模只需要计算$|v| = \sqrt{v^{⊤}v}$即可，而若对复向量使用$z^{⊤}z$则有

$$
z^{⊤}z= \begin{bmatrix}
z_1 & z_2 & ⋯ & z_n
\end{bmatrix}
\begin{bmatrix}
z_1\\
z_2\\
⋮\\
z_n
\end{bmatrix} = ∑z_i^2
$$

这里$z_i$是复数，平方后虚部为负，求模时本应相加的运算变成了减法。

> 如向量$\begin{bmatrix}1 & i\end{bmatrix}$，右乘其转置后结果为$0$，但此向量的长度显然不是零。

应使用$|z| = \sqrt{z̄^{⊤}z}$，即

$$
\begin{bmatrix}
z̄_1 & z̄_2 & ⋯ & z̄_n
\end{bmatrix}
\begin{bmatrix}
z_1\\
z_2\\
⋮\\
z_n
\end{bmatrix}
$$

即使用向量共轭的转置乘以原向量即可。

> 如向量$\begin{bmatrix}1 & i\end{bmatrix}$，右乘其共轭转置后结果为$\begin{bmatrix}1 & -i\end{bmatrix}\begin{bmatrix}1\\i\end{bmatrix} =2$。

我们把共轭转置乘以原向量记为$z^{H}z$，$H$读作 Hermitian。

有了复向量模的计算公式，同理可得，对于复向量，内积不再是实向量的$y^{⊤} x$形式，复向量内积应为$y^{H}x$。

### 1.1. 复向量的性质

对于实矩阵，$𝑨^{⊤} = A$即可表达矩阵的对称性。而对于复矩阵，同样需要求一次共轭$Ā^{⊤} =A$。

如$\begin{bmatrix}2 & 3 + i\\ 3 - i &5\end{bmatrix}$是一个复数情况下的对称阵。这称为 Hermitian 矩阵，有性质$A^{H}=A$。

此前，我们定义标准正交向量：$q_i^{⊤}q_{j} = \begin{cases}0 i ≠ j\\1 i = j\end{cases}$。现在，对于复向量我们需要求共轭：

$$
q̄_i^{⊤} q_{j} = q_i^{H} q_{j} =
\begin{cases}
  0 & i ≠ j\\
  1 & i = j
\end{cases}
$$

此前，我们定义标准正交矩阵：$𝑸 = \big[q_1\ q_2\ ⋯\ q_n\big]$有$𝑸^{⊤}𝑸 = 𝑰$。现在对于复矩阵则有

$$
𝑸^{H}𝑸=i
$$

正交性（orthogonal）在复数情况下也有了新名字，酉（unitary），酉矩阵（unitary matrix）与正交矩阵类似，满足$𝑸^{H}𝑸 = 𝑰$的性质。

### 1.2. 复数共轭

**定义**：设$z= a + bi$，其中，$a$和$b$是实数。

- $z$的实部，表示为$\mathrm{Re}z$，由$\mathrm{Re}z = a$定义。
- $z$的虚部，表示为$\mathrm{Im}z$，由$\mathrm{Im}z = b$定义。

**定义**：设$z ∈ C$

- $z ∈ C$中的复共轭，表示$z̄$定义为

$$
z̄ = \mathrm{Re}z - (\mathrm{Im}z) i
$$

- 复数$z$的绝对值表示为$|z|$，定义为

$$
|z| = \sqrt{(\mathrm{Re}z)^2 + (\mathrm{Im}z)^2}。
$$

设$w, z ∈ C$，则

- $z$和$z̄$之和：$z + z̄ = 2{\mathrm{Re}z}$
- $z$和$z̄$之差：$z - z̄ = 2(\mathrm{Im}z)i$
- $z$和$z̄$之积：$zz̄ = |z|^2$
- 复共轭可加性：$\overline{w + z} = wz̄ + z̄$
- 复共轭可乘性：$\overline{w z} = wz̄z̄$
- 共轭的共轭：$\overline{z̄} = z$
- 复共轭的绝对值：$|z̄| = |z|$
- 绝对值的倍增性：$|wz| = |w||z|$
- 三角形不平等：$|w + z| ≤ |w|+|z|$
- 实部和虚部的边界为$|z|$

$$
\begin{aligned}
  |\mathrm{Re}z| ≤ |z| \\
  |\mathrm{Im}z| ≤ |z|
\end{aligned}
$$

## 2. 复矩阵

### 2.1. 傅里叶矩阵

$n$阶傅里叶矩阵

$$
𝑭_n = \begin{bmatrix}
1 & 1 & 1 & ⋯ & 1\\
1 & w & w^2 & ⋯ & w^{n-1} \\
1 & w^2 & w^4 & ⋯ & w^{2(n - 1)} \\
⋮ & ⋮ & ⋮ & ⋱ & ⋮\\
1 & w^{n-1} & w^{2(n - 1)} & ⋯ & w^{(n - 1)^2}
\end{bmatrix}
$$

对于每个元素有$(𝑭_n)_{ij} = w^{ij} i, j = 0, 1, 2, ⋯, n-1$。矩阵中的$w$是一个非常特殊的值，满足$w^n = 1$，其公式为$w = e^{i2π/n}$。易知$w$在复平面的单位圆上，$w= \cos\frac{2π}{n} +i\sin\frac{2π}{n}$。

在傅里叶矩阵中，当计算$w$的幂时，$w$在单位圆上的角度翻倍。如在$6$阶情形下，$w = e^{2π/6}$，即位于单位圆上${60}^{∘}$角处，其平方位于单位圆上${120}^{∘}$角处，而$w^6$位于$1$处。从开方的角度看，它们是$1$的$6$个六次方根，而一次的$w$称为原根。

现在来看$4$阶傅里叶矩阵，先计算$w$有$w = i, \ w^2 = -1, \ w^3 = -i, \ w^4 = 1$，

$$
𝑭_4=
\begin{bmatrix}
  1 & 1 & 1 & 1\\
  1 & i & i^2 & i^3\\
  1 & i^2 & i^4 & i^6\\
  1 & i^3 & i^6 & i⁹
\end{bmatrix} =
\begin{bmatrix}
  1 & 1 & 1 & 1\\
  1 & i & -1 & -i\\
  1 & -1 & 1 & -1\\
  1 & -i & -1 & i
\end{bmatrix}
$$

矩阵的四个列向量正交，验证一下第二列和第四列，$cz̄_x^{⊤}c_4 = 1 - 0 + 1 - 0 = 0$，正交。不过我们应该注意到，$𝑭_4$的列向量并不是标准的，我们可以给矩阵乘上系数$\frac{1}{2}$（除以列向量的长度）得到标准正交矩阵

$$
𝑭_4= \frac{1}{2}
\begin{bmatrix}
  1 & 1 & 1 & 1\\
  1 & i & -1 & -i\\
  1 & -1 & 1 & -1\\
  1 & -i & -1 & i
\end{bmatrix}
$$

此时有$𝑭_4^{H}𝑭_4= 𝑰$，于是该矩阵的逆矩阵也就是其共轭转置$𝑭_4^{H}$。

### 2.2. 快速傅里叶变换

对于傅里叶矩阵，$𝑭_6, \ 𝑭_3$、$𝑭_8, \ 𝑭_4$、$𝑭_{64}, \ 𝑭_{32}$之间有着特殊的关系。

有傅里叶矩阵$𝑭_{64}$，一般情况下，用一个列向量右乘$𝑭_{64}$需要约${64}^2$次计算，显然这个计算量是比较大的。我们想要减少计算量，于是想要分解$𝑭_{64}$，联系到$𝑭_{32}$，有

$$
\big[𝑭_{64} \big] =
\begin{bmatrix}
  𝑰 & 𝑫\\ 𝑰& -𝑫
\end{bmatrix}
\begin{bmatrix}
  𝑭_{32} & 0\\0 & 𝑭_{32}
\end{bmatrix}
\begin{bmatrix}
  1 & & ⋯ & & & 0 & & ⋯ & &\\
  0 & & ⋯ & & & 1 & & ⋯ & &\\
  & 1 & ⋯ & & & & 0 & ⋯ & &\\
  & 0 & ⋯ & & & & 1 & ⋯ & &\\
  & & & ⋱ & & & & & ⋱ & &\\
  & & & ⋱ & & & & & ⋱ & &\\
  & & & ⋯ & 1 & & & & ⋯ & 0\\
  & & & ⋯ & 0 & & & & ⋯ & 1
\end{bmatrix}
$$

我们分开来看等式右侧的这三个矩阵：

- 第一个矩阵由单位矩阵$𝑰$和对角矩阵

$$
𝑫 = \begin{bmatrix}
  1 & & & &\\
  & w & & &\\
  & & w^2 & &\\
  & & &   ⋱ &\\
  & & & & w^{31}
\end{bmatrix}
$$

组成，这个矩阵被称为修正矩阵，显然其计算量来自$𝑫$矩阵，对角矩阵的计算量约为 32 即这个修正矩阵的计算量约为 32，单位矩阵的计算量忽略不计。

- 第二个矩阵是两个$𝑭_{32}$与零矩阵组成的，计算量约为$2 × 32^2$。
- 第三个矩阵通常记为$𝑷$矩阵，这是一个置换矩阵，其作用是讲前一个矩阵中的奇数列提到偶数列之前，将前一个矩阵从$[x_0\ x_1\ ⋯]$变为$[x_0\ x_2\ ⋯\ x_1\ x_3\ ⋯]$，这个置换矩阵的计算量也可以忽略不计。

故我们把${64}^2$复杂度的计算化简为$2× 32^2 + 32$复杂度的计算，我们可以进一步化简$𝑭_{32}$得到与$𝑭_{16}$有关的式子

$$
\begin{bmatrix}
  𝑰_{32} & 𝑫_{32} \\
  𝑰_{32} & -𝑫_{32}
\end{bmatrix}
\begin{bmatrix}
  𝑰_{16} & 𝑫_{16} & &\\
  𝑰_{16} & -𝑫_{16} & &\\
  & & 𝑰_{16} & 𝑫_{16} \\
  & & 𝑰_{16} & -𝑫_{16}
\end{bmatrix}
\begin{bmatrix}
  𝑭_{16} & & &\\
  & 𝑭_{16} & &\\
  & & 𝑭_{16} &\\
  & & & 𝑭_{16}
\end{bmatrix}
\begin{bmatrix}
  P_{16} &\\
  & P_{16}
\end{bmatrix}
\big[P_{32}\big]
$$

而${32}^2$的计算量进一步分解为$2 × 16^2 + 16$的计算量，如此递归下去我们最终得到含有一阶傅里叶矩阵的式子。

化简后计算量，$2 (2(2(2(2(2(1)^2 + 1) +2) +4) +8) + 16) +32$，约为$6 × 32 = \log_2{64}×\frac{64}2$，算法复杂度为$\frac{n}{2} \log_2n$。原来需要$n^2$的运算现在只需要$\frac{n}{2}\log_2n$就可以实现了。
