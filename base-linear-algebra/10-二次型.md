# 二次型

## 1. 二次型

### 1.1. 二次型矩阵

**定义**：关于一些变量的二次齐次多项式被称为二次型（quadratic form），如

$$
\begin{gather}
3x_1^2 + 2x_1x_2 + x_2^2 \\
x_1^2 - 2x_2^2
\end{gather}
$$

由上，根据矩阵乘法，二次型$(2)$式可以写成

$$
\begin{aligned}
x_1^2 - 2x_2^2
&= 3x_1 ⋅ x_1 -2x_2 ⋅ x_2 \\
&= \begin{bmatrix}
3x_1 - 7x_2
\end{bmatrix}
\begin{bmatrix}
x_1 \\ x_2
\end{bmatrix} \\
&= \begin{bmatrix}
x_1 & x_2
\end{bmatrix}
\begin{bmatrix}
3 & 0 \\ 0 & -7
\end{bmatrix}
\begin{bmatrix}
x_1 \\ x_2
\end{bmatrix}
\end{aligned}
$$

令$𝒙 = \begin{bmatrix}x_1 \\ x_2\end{bmatrix}$且$𝑨 = \begin{bmatrix}3 & 0 \\ 0 & -7 \end{bmatrix}$，则

$$
x_1^2 - 2x_2^2 = 𝒙^{⊤}𝑨𝒙
$$

:::{admonition} 定理

设$f$是定义在$ℝ^n$上的二次型，则其可写作

$$
f = 𝒙^{⊤}𝑨𝒙
$$

其中，$𝑨$为$n$阶对称阵，矩阵$𝑨$称为$f$的二次型矩阵。

:::

### 1.2. 合同矩阵

**定义**：设矩阵$𝑨$和$𝑩$为$n$阶方阵，若存在可逆矩阵$𝑷$，使得

$$
𝑩 = 𝑷^{⊤}𝑨𝑷
$$

则称矩阵$𝑨$和$𝑩$合同（congruence）。

:::{admonition} 定理

若$𝑨$为对称阵，则其合同矩阵$𝑩$也是对称阵，记作

$$
𝑨 ≃ 𝑩
$$

:::

> 合同矩阵就是二次型的坐标变换矩阵。

:::{admonition} 传递性

若$𝑨 ≃ 𝑩$，且$𝑩 ≃ 𝑪$，则

$$
𝑨 ≃ 𝑪
$$

:::

:::{admonition} 定理

合同矩阵的秩相同。

:::

## 2. 二维应用

### 2.1. 圆

对圆心为$(x_0, x_1)$，半径为$r$的圆，有方程

$$
(x_0 - α_0)^2 + (x_1 - α_1)^2 = r^2
$$

其可被重写为

$$
\begin{bmatrix}
(x_0 - α_0) & (x_1- α_1)
\end{bmatrix}
\begin{bmatrix}
1 & 0 \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
(x_0 - α_0) \\
(x_1- α_1)
\end{bmatrix} = r^2
$$

记位置向量$\begin{bmatrix}x_0\\ x_1\end{bmatrix}$为$𝒙$，圆心为$\mathbf{α}$，则有

$$
(𝒙 - \mathbf{α})^{⊤}𝑰(𝒙 - \mathbf{α}) = r^2
$$

以这种矩阵格式表述，它不再局限于二维。事实上，它是一个超球体。

### 2.2. 椭圆

对椭圆

$$
\frac{(x_0 - α_0)^2}{β_0^2} + \frac{(x_1 - α_1)^2}{β_1^2}=1
$$

记位置向量为$𝒙 = \begin{bmatrix} (x_0 - α_0) \\ (x_1 - α_1) \end{bmatrix}$，则

$$
𝒙^{⊤}𝜦𝒙 = 1
$$

其中，对角矩阵为

$$
𝜦 =
\begin{bmatrix}
\dfrac{1}{a^2} & 0 \\
0 & \dfrac{1}{b^2}
\end{bmatrix}
$$

椭圆在新的（旋转的）坐标系中的方程是

$$
\begin{aligned}
(𝑹𝒙)^{⊤}𝜦(𝑹𝒙) &= 1 \\
⇕&\\
𝒙^{⊤}(𝑹^{⊤}𝜦𝑹) 𝒙 &= 1
\end{aligned}
$$

椭圆的广义方程为

$$
𝒙^{⊤}𝑨𝒙 = 1
$$

其中，$𝑨 = (𝑹^{⊤}𝜦𝑹)$，为对称阵。

等价地，可以使用，$𝑸 = \dfrac{𝒙^{⊤}𝑨𝒙}{𝒙^{⊤}𝒙}$。在所有可能的方向$𝒙̂$上搜索，检查哪个方向上$𝑸 = 𝒙̂^{⊤}𝑨𝒙̂$最小。

对角化，可得

$$
\begin{aligned}
𝑸 &= 𝒙^{⊤}𝑨𝒙 \\
&= 𝒙^{⊤}𝑺𝜦𝑺^{⊤}𝒙
\end{aligned}
$$

其中，$𝑺 = (𝒆_1\ 𝒆_2\ ⋯\ 𝒆_n)$为$𝑨$的特征向量。$𝜦$为由$𝑨$的特征值构成的对角矩阵。

令$𝒚̂ = 𝑺^{⊤}𝒙$，则有

$$
𝑸 = 𝒚̂^{⊤}𝜦𝒚̂
$$

注意，由于$𝑨$是对称的，其特征向量是正交的。这意味着$𝑺$是一个正交矩阵，即$𝑺𝑺^{⊤} = 𝑰$。且$∥𝒚̂∥^2 = 1$。于是

$$
\begin{aligned}
𝑸
&= \begin{bmatrix}
y_1 & y_2 & ⋯ & y_n
\end{bmatrix}
\begin{bmatrix}
λ_1 & 0 & ⋯ & 0 \\
0 & λ_2 & ⋯ & 0 \\
⋮ & ⋮ & ⋮ & ⋮ \\
0 & 0 & ⋯ & λ_n
\end{bmatrix}
\begin{bmatrix}
y_1 \\ y_2 \\ ⋮ \\ y_n
\end{bmatrix} \\
&= ∑_{i=1}^n λ_i y_i^2
\end{aligned}
$$

> 可以假设，特征值按大小顺序递减排序

因此

- 当$𝒙̂$沿着$𝑨$的最大特征值对应的特征向量时，二次型$𝑸 = 𝒙̂^{⊤}𝑨𝒙̂$最大
- 当$𝒙̂$沿着$𝑨$的最小特征值对应的特征向量时，二次型取得最小值

## 3. Lagrange 配方法

### 3.1. 步骤

:::{admonition} Lagrange 配方法

1. 遇到平方项$x_i^2$，先对其进行配方
2. 遇到交叉项$x_ix_j$，且没有对应平方项，进行换元

$$
\begin{cases}
  x_i = y_i + y_j \\
  x_j = y_i - y_j \\
  x_k = y_k, \ k ∈ \big[1, n\big], k ≠ i, j
\end{cases}
$$

得到平方项后回到步骤 1

3. 不断重复直至消除所有交叉项

:::

### 3.2. 双曲线

判断以下二次型的曲线类型

$$
x_1x_2 = 1
$$

通过 Lagrange 配方法换元，有

$$
\begin{cases}
  x_1 = y_1 + y_2 \\
  x_2 = y_1 - y_2
\end{cases}
$$

从而

$$
x_1x_2 = 1 ⟶ y_1^2 - y^2 = 1
$$

上述过程可改写为

$$
\begin{cases}
x_1 = y_1 + y_2 \\
x_2 = y_1 - y_2
\end{cases} ⟹
\begin{bmatrix}
x_1 \\ x_2
\end{bmatrix} =
\begin{bmatrix}
1 & 1 \\ 1 & -1
\end{bmatrix}
\begin{bmatrix}
y_1 \\ y_2
\end{bmatrix}
$$

令三个部分分别为$\big[𝒙\big]_ε$、$𝐌$和$\big[𝒙\big]_ℳ$，可得坐标变换公式

$$
\big[𝒙\big]_ε = 𝐌\big[𝒙\big]_ℳ
$$

即

$$
\begin{aligned}
x_1x_2 &= \big[𝒙\big]_ε^{⊤}\begin{bmatrix}
0 & 1/2 \\ 1/2 & 0
\end{bmatrix}
\big[𝒙\big]_ε
&= (𝐌\big[𝒙\big]_ℳ^{⊤})
\begin{bmatrix}
0 & 1/2 \\ 1/2 & 0
\end{bmatrix}
𝐌 \big[𝒙\big]_ℳ \\
&= \big[𝒙\big]_ℳ^{⊤} 𝐌^{⊤}
\begin{bmatrix}
0 & 1/2 \\ 1/2 & 0
\end{bmatrix}
𝐌_ℳ \big[𝒙\big]_ℳ \\
&= \big[𝒙\big]_ℳ^{⊤}
\begin{bmatrix}
1 & 1 \\ 1 & -1
\end{bmatrix}
\begin{bmatrix}
0 & 1/2 \\ 1/2 & 0
\end{bmatrix}
\begin{bmatrix}
1 & 1 \\
1 & -1
\end{bmatrix}
\big[𝒙\big]_ℳ \\
&= \big[𝒙\big]_ℳ^{⊤}
\begin{bmatrix}
1 & 0 \\ 0 & -1
\end{bmatrix}
\big[𝒙\big]_ℳ
\end{aligned}
$$

令$𝑨 = \begin{bmatrix}0 & 1/2 \\ 1/2 & 0 \end{bmatrix}$，$𝜦 = \begin{bmatrix}1 & 0 \\ 0 & -1\end{bmatrix}$

不难得出

$$
𝑨 ≃ 𝜦
$$

## 4. 正定矩阵

### 4.1. 惯性定理

:::{admonition} Sylvester's 惯性定理

对于某二次型$f$，可化为多个标准型。其以下指标都相同

- 正惯性指数（正系数的数目）
- 负惯性指数（负系数的数目）
- 0 系数

:::

### 4.2. 正定与负定

**定义**：设二次型$f(x) = 𝒙^{⊤}𝑨𝒙$，则其是

- 正定的：若$∀𝒙 ≠ 𝟎, \ ∃ f(𝒙) > 0$
- 半正定的：若$f(𝒙) ≥ 0$
- 负定的：若$∀𝒙 ≠ 𝟎, \ ∃ f(𝒙) < 0$
- 半负定的：若$f(𝒙) ≤ 0$
- 不定的：若$f(𝒙)$有正有负

:::{admonition} 定理

设$𝑨$是$n$阶方阵，则其在以下情况不正定

1. 任何对角线项$≤ 0$
2. $|𝑨| ≤ 0$
3. $𝑨$中的最大数字的绝对值偏离对角线值的范围外

:::

:::{admonition} Hurwitz 定理

已知二次型$f(x) = 𝒙^{⊤}𝑨𝒙$，其为正定的充要条件为，$𝑨$的各阶主子式均为正，即

$$
a_11 > 0,
\begin{vmatrix}
a_{11} & a_{12} \\
a_{21} & a_{22}
\end{vmatrix} > 0,
\begin{vmatrix}
a_{11} & … & a_{1n} \\
⋮ & ⋱ & ⋮ \\
a_{n1} & … & a_{nn}
\end{vmatrix} > 0
$$

为负定的充要条件是

$$
(-1)^r
\begin{vmatrix}
a_{11} & … & a_{1n} \\
⋮ & ⋱ & ⋮ \\
a_{n1} & … & a_{nn}
\end{vmatrix}
> 0, \ r ∈ \big[1, n\big]
$$

:::

### 4.3. 性质

:::{admonition} 定理

- 正定矩阵的逆矩阵也是正定的
- 正定矩阵之和也是正定的

:::
